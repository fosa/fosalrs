% coding:utf-8

%FOSALRS, a LaTeX-Code for a electrical summary of control theory
%Copyright (C) 2013, Daniel Winz, Ervin Mazlagic

%This program is free software; you can redistribute it and/or
%modify it under the terms of the GNU General Public License
%as published by the Free Software Foundation; either version 2
%of the License, or (at your option) any later version.

%This program is distributed in the hope that it will be useful,
%but WITHOUT ANY WARRANTY; without even the implied warranty of
%MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%GNU General Public License for more details.
%----------------------------------------

\chapter{Fourier Transformation}

\section{Fourier-Reihen}
Periodische Funktionen\\
Sein $u(t)$ eine $T$-periodische Funktion. D.h. 
\[ u(t + T) = u(t) \]
Die Funktion lässt sich in eine Fourier-Reihe entwickeln: 
\[ u(t) = \frac{a_0}{2} + \sum\limits_{n = 1}^{\infty} 
(a_n \cdot \cos(n \cdot \omega_0 \cdot t) 
+ b_n \cdot \sin(n \cdot \omega_0 \cdot t)) \]
Hierbei ist $\omega_0 = \frac{2 \pi}{T}$ die Grundschwingung. \\
Die Funktion lässt sich auffassen als Überlagerung von harmonischen 
Schwingungen der Grundfrequenz $\omega_0$ und ganzzahligen Vielfachen 
$n \cdot \omega_0$ der Grundfrequenz. Dies sind die Oberschwingungen oder 
Obertöne. \\
Frage: Kann msn nicht periodische Signale auffassen als Überlagerung von 
harmonischen Schwingungen? \\
Bsp. Rechteckschwingung, $T = 2 \pi, \omega_0 = 1$\\
\[ u(t) = \frac{1}{2} + \frac{2}{\pi} \cdot \sin(t) 
+ \frac{2}{3\pi} \cdot \sin(3t) 
+ \frac{2}{5\pi} \cdot \sin(5t) + \ldots \]
\[ u(t) = \frac{1}{2} + \sum\limits_{k = 0}^{\infty} 
\left(\frac{2}{\pi} \cdot \frac{\sin((2 k + 1) \cdot t)}{2 k + 1}\right) \]
D.h. 
\[ a_n = 0 \qquad \text{für alle }n = 1, 2, 3, \ldots \]
\[ a_0 = 1 \]
\[ b_n = \left\lbrace
\begin{array}{l}
\frac{2}{n \cdot \pi}, \qquad n \text{ ungerade}
0, \qquad n \text{ gerade}
\end{array}
\right. \]
\subsubsection{Formeln zur Berechnung der Koeffizienten}
\[ a_0 = \frac{2}{T} \int\limits_{-\frac{T}{2}}^{\frac{T}{2}} u(t) ~ dt \]
\[ a_0 = \frac{2}{T} \int\limits_{-\frac{T}{2}}^{\frac{T}{2}} u(t) 
\cos(n \cdot \omega_0 \cdot t) ~ dt \]
\[ b_0 = \frac{2}{T} \int\limits_{-\frac{T}{2}}^{\frac{T}{2}} u(t) 
\sin(n \cdot \omega_0 \cdot t) ~ dt \]

\subsection{Komplexe oder Exponentialform der Fourier-Reihe}
Erinnerung: Eulersche Formel: 
\[ e^{j x} = \cos(x) + j \sin(x) \qquad , x \in \mathbb{R} \]
\[ e^{- j x} = \cos(-x) + j \sin(-x) \]
\[ e^{- j x} = \cos(x) - j \sin(x) \]
\[ e^{j x} = \cos(x) + j \sin(x) \]
\[ e^{jx} + e^{-jx} = 2 \cos(x) \]
\[ \boxed{\cos(x) = \frac{1}{2} (e^{jx} + e^{-jx})} \]
\[ e^{jx} - e^{-jx} = 2 j \sin(x) \]
\[ \boxed{\sin(x) = \frac{1}{2j} (e^{jx} - e^{-jx})} \]
Wir wenden diese beiden Formeln auf die Fourierreihen an: 
\[ u(t) = \frac{a_0}{2} + \sum\limits_{n = 1}^{\infty} (a_n \cos(n \omega_0 t) 
+ b_n \sin(n \omega_0 t)) \]
\[ u(t) = \frac{a_0}{2} + \sum\limits_{n = 1}^{\infty} 
(a_n \frac{e^{j n \omega_0 t} + e^{-j n \omega_0 t}}{2} 
+ b_n \frac{e^{j n \omega_0 t} + e^{-j n \omega_0 t}}{2 j}) \]
\[ u(t) = \frac{a_0}{2} + \sum_{n = 1}^{\infty} \left(
\underbrace{\left(\frac{a_n}{2} + \frac{b_n}{2j}\right)}
_{\dfrac{a_n - b_n j}{2} = c_n} \cdot e^{j n \omega_0 t} + 
\underbrace{\left(\frac{a_n}{2} - \frac{b_n}{2j}\right)}
_{\dfrac{a_n + b_n j}{2} = c_{-n}}\cdot e^{-j n \omega_0 t}
\right) \]
\[ u(t) = c_0 + \sum\limits_{n = 1}^{\infty} \left(c_n \cdot e^{j n \omega_0 t} 
+ c_{-n} \cdot e^{j n \omega_0 t}\right) 
= c_0 + \sum\limits_{n = 1}^{\infty} c_n e^{j n \omega_0 t} \]
Komplexe Form der Fourier-Reihe
\[ u(t) = c_0 + \sum\limits_{n = 1}^{\infty} c_n e^{j n \omega_0 t} \]
\[ c_n = \frac{1}{T} \int\limits_{-\frac{T}{2}}^{\frac{T}{2}} 
u(t) \cdot e^{-j n \omega_0 t} ~ dt \]
Zurück zum Bsp. (Rechteckschwingung)
\[ c_0 = \frac{a_0}{2} = \frac{1}{2} \]
\[ c_n = \frac{a_n - b_n j}{2} = -\frac{1}{n \pi} 
\qquad \text{für }n > 0\text{ ungerade} \]
\[ c_{-n} = \frac{a_n + b_n j}{2} = \frac{1}{n \pi} 
\qquad \text{für }n > 0\text{ ungerade} \]
Also: 
\[ c_n = -\frac{1}{n \pi} j \qquad \text{für alle ungeraden }n\]
\[ c_n = 0 \qquad \text{für alle geraden }n\]
\[ u(t) = \ldots - \frac{j}{3 \pi} e^{-3 t j} - \frac{j}{\pi} e^{-t j} 
+ \frac{1}{2} - \frac{j}{\pi} e^{t j} - \frac{j}{3 \pi} e^{3 t j} - \ldots \]
Sei $u(t)$ eine (nicht periodische) Funktion. Wir fassen $u(t)$ als 
$\infty$-periodisch auf. 
\[ u(t) = \sum\limits_{n = -\infty}^{\infty} c_n e^{n \omega_0 t j} \]
\[ u(t) = \sum\limits_{n = -\infty}^{\infty} \frac{1}{T} 
\left(\int\limits_{-\frac{T}{2}}^{\frac{T}{2}} u(t) e^{-n \omega_0 t j} ~ dt 
\right)\cdot  e^{n \omega_0 t j} \]
\[ u(t) = \frac{1}{2 \pi} \sum\limits_{n = -\infty}^{\infty}
\left(\int\limits_{-\frac{T}{2}}^{\frac{T}{2}} u(t) e^{-n \omega_0 t j} ~ dt 
\right)\cdot  e^{n \omega_0 t j} \cdot \Delta \omega \]
Hierbei ist $\Delta \omega = \omega_0$. Wir lassen $T \to \infty$ gehen. 
\[ \omega_0 = \frac{2 \pi}{T} \to 0 \]
\[ u(t) = \frac{1}{2 \pi} \]
\[ u(t) = \frac{1}{2 \pi} \int\limits_{-\infty}^{\infty}
\underbrace{\left(\int\limits_{-\infty}^{\infty} u(t) e^{-\omega t} ~ dt 
\right)}_{U(\omega)}\cdot  e^{-\omega t j} ~ d\omega \]
Definition: Die Fourier-Transfoermierte des Signals $u(t)$ ist 
\[ U(\omega) = \mathcal{F}\{ u(t) \} = \int\limits_{-\infty}^{\infty} 
u(t) e^{-\omega t} ~dt \]
Man nenn $U(\omega)$ Spektraldichte oder Spektralfunktion. 

\subsubsection{Umkehrformel}
\[ u(t) = \frac{1}{2 \pi} \int\limits_{-\infty}^{\infty} 
U(\omega) e^{\omega t j} ~ d\omega \]

\subsubsection{Darstellung con $U(\omega)$}
\begin{enumerate}
\item \[ U(\omega) \in \mathbb{C} \text{für} \omega \in \mathbb{R} \]
Kurve in der Ebene
\item Erinnerung: Polarform
\[ z = r \cdot e^{\varphi j} 
\qquad \text{wobei }r \geq 0, -\pi < \varphi \leq \pi \]
\end{enumerate}
\[ U(\omega) = |U(\omega)] \cdot e^{\varphi(\omega) j} \]
Amplitudenspektrum\\
>>>FOSA Bild Amplitudenspektrum\\
Phasenspektrum\\
>>>FOSA Bild Phasenspektrum\\
Bsp3
\[ u(t) = 1 \]
\[ U(\omega) = \mathcal{F}\{1\} 
= \int\limits_{-\infty}^{\infty} u(t) \cdot e^{-\omega t j} ~ dt 
= \int\limits_{-\infty}^{\infty} e^{-\omega t j} ~ dt 
= \left.-\frac{1}{\omega j} \cdot e^{-\omega t j}\right|
_{t = -\infty}^{t = \infty} \]
\[ = -\frac{1}{\omega j} \left(\lim\limits_{t \to \infty} e^{-\omega t j} 
- \lim\limits_{t \to -\infty} e^{-\omega t j}\right) \]
Bsp 4
\[ u(t) = \delta(t) \]
\[ U(\omega) = \mathbb{F}\{\delta (t)\} = \int\limits_{-\infty}^{\infty} 
\delta (t) e^{-\omega t j} ~dt = 1 \]

\subsection{Repetition / Zusammenfassung}
Fourieranalyse: Welche Frequenzen sind in einem Signal vorhanden? 
\begin{itemize}
  \item Periodische Signale $\to$ Fourier-Reihe
        \[ u(t) = \sum\limits_{n = -\infty}^{\infty} c_n \cdot e^{n \omega_0 t j} 
        \qquad \omega_0 = \frac{2 \pi}{T} \]
        Falls $u(t)$ reell ist, gilt: 
        \[ c_{-n} = \overline{c_n} \]
        \[ |c_{-n}| = |c_n| \]
        \[ \varphi_{-n} = - \varphi_n \]
        \[ c_n = |c_n| \cdot e^{\varphi n j} \]
        >>>FOSA Grafik zu diskretem Amplituden- und Phasenspektrum
                (Spektrallinien, Diskretes Spektrum)
  \item Nicht periodische Signale $\to$ Fourier-Transformation
        \[ u(t) = \frac{1}{2 \pi} \int\limits_{-\infty}^{\infty} U(\omega) 
        \cdot e^{\omega t j} ~ d\omega \]
        \[ U(\omega) = \mathcal{F}\{ u(t) \} =  \int\limits_{-\infty}^{\infty} 
        u(t) \cdot e^{-\omega t j} ~ dt \]
        Fourier-Transformierte oder Spektraldichte von $u(t)$
        \[ U(\omega) = A(\omega) \cdot e^{\varphi(\omega) j} \]
        \[ A(\omega) = |U(\omega)| \leq 0 \]
        \[ \varphi(\omega) = arg ~ U(\omega) \in (-\pi , \pi \rbrack \]
        \[ \tan(\varphi(\omega)) = \frac{Im(U(\omega))}{Re(U(\omega))} \]
        Falls $u(t)$ reell ist, gilt: 
        \[ A(-\omega) = A(\omega) \qquad \varphi(-\omega) = -\varphi(\omega) \]
        >>>FOSA Grafik zu kontinuierlichem Amplituden- und Phasenspektrum
\end{itemize}

\subsection{Unschärferelation}
\[ \Delta t \cdot \Delta \omega = const \]
\[ \Rightarrow \Delta \omega \text{ umgekehrt proportional zu } \Delta t \]

\subsection{Fouriertransformation als Spezialfall der Laplacetransformation}
Beidseitige Laplacetransformation: 
\[ \mathcal{L}_{II} \{ u(t) \} = \int\limits_{-\infty}^{\infty} u(t) \cdot e^{-s t} ~ dt \]
Fouriertransformation: 
\[ \mathcal{F}      \{ u(t) \} = \int\limits_{-\infty}^{\infty} u(t) \cdot e^{-s t} ~ dt \]
Rezept: funktioniert nicht immer! 
\begin{enumerate}
  \item Laplacetransformation berechnen
  \item $s = \omega j$ ersetzen
  \item Ergebnis ist Fouriertransformation
\end{enumerate}
Kriterium: Falls 
\[ \int\limits_{-\infty}^{\infty} |u(t)| ~ dt < \infty \]
dann funktioniert das Rezept. 
Dies gilt insbesondere, wenn das Signal eine endliche Dauer hat. 

\section{Inverse Fouriertransformation}
Siehe HErleitung der Fouriertransformation: 
\[ u(t) = \frac{1}{2 \pi}  \int\limits_{-\infty}^{\infty} U(\omega) \cdot e^{\omega t j} ~ d\omega \]
\[ U(\omega) = \mathcal{F} \{ u(t) \} \]
\[ u(t) = \mathcal{F}^{-1} \{ U(\omega) \} \]

\subsection{Symmetrie}
\[ U(\omega) = \int\limits_{-\infty}^{\infty} u(t) \cdot e^{-\omega t j} ~ dt \]
Variabeln umbenennnen: 
\[ t \to -\omega \qquad \omega \to t \]
\[ u(-\omega) = \frac{1}{2 \pi} \underbrace{\int\limits_{-\infty}^{\infty} 
U(t) \cdot e^{t (-\omega) j} ~ dt}_{\mathcal{F} \{ U(t) \}} \]
\[ \mathcal{F} \{ U(t) \} = 2 \pi \cdot u(-\omega) \]
Also: 
\[ \boxed{\begin{array}{lll}
u(t) & \laplace & U(\omega)\\
U(t) & \laplace & 2 \pi \cdot u(-\omega)
\end{array}} \]


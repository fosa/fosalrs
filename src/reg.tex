% coding:utf-8

%FOSALRS, a LaTeX-Code for a electrical summary of control theory
%Copyright (C) 2013, Daniel Winz, Ervin Mazlagic

%This program is free software; you can redistribute it and/or
%modify it under the terms of the GNU General Public License
%as published by the Free Software Foundation; either version 2
%of the License, or (at your option) any later version.

%This program is distributed in the hope that it will be useful,
%but WITHOUT ANY WARRANTY; without even the implied warranty of
%MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%GNU General Public License for more details.
%----------------------------------------

\section{Systemtheorie}

\subsection{Steuerung}
\begin{figure}[h!]
    \centering
    >>>FOSA: Grafik zu Steuerung
    \caption{Steuerung}
    \label{fig:control}
\end{figure}
Einfach zu Implementieren
keine Korrektur von Störungen

\subsection{Regelung}
\begin{figure}[h!]
    \centering
    >>>FOSA: Grafik zu Systemtheorie
    \caption{Regelkreis}
    \label{fig:regsystem}
\end{figure}
\begin{tabular}{@{}ll}
$r$ & Sollwert, Führungsgrösse (manchmal $w$) \\
$e$ & Regeldifferenz \\
$u$ & Stellgrösse \\
$y$ & Regelgrösse, Ausgangsgrösse \\
$d$ & Störgrösse (Eher v bei Rauschen)
\end{tabular}
\[ \boxed{e = r - y} \]
\[ \boxed{e(t) = r(t) - y(t)} \]
\begin{figure}[h!]
    \centering
    >>>FOSA: Grafik zu Regelkreis mit Feed forward
    \caption{Regelkreis mit Feed forward}
    \label{fig:feedforward}
\end{figure}
2 Degrees of freedom

\section{Eigenschaften eines Regelkreises}
Ein Regler kann nur entweder für das Führungsverhalten oder für das 
Störverhalten optimiert werden. 

\subsection{Führungsverhalten}
\begin{figure}[h!]
    \centering
    >>>FOSA: Grafik zu Führungsverhalten
    \caption{Führungsverhalten}
    \label{fig:fhr}
\end{figure}
\begin{itemize}
  \item maximales Überschwingen
  \item stationäre Genauigkeit
  \item Anregelzeit (Anstiegszeit (Reaktionszeit))
\end{itemize}

\subsection{Störverhalten}
\begin{figure}[h!]
    \centering
    >>>FOSA: Grafik zu Störverhalten
    \caption{Störverhalten}
    \label{fig:str}
\end{figure}
\begin{itemize}
  \item maximales Unterschwingen
  \item Ausregelzeit
  \item Stationäre Regelabweichung
\end{itemize}

\section{LZI -- Lineare zeitinvariante Elemente}
bounded Input $\rightarrow$ bounded output -- BIBO\\
P-Anteil: Grundsätzliche Stabilisierung \\
I-Anteil: Reduktion der Regeldifferenz auf 0 \\
D-Anteil: Becshleunigung des Reglers

\subsection{Prüfung auf Linearität}
\begin{enumerate}
  \item Überlagerungsprinzip erfüllt 
        \[ y = f(u) \qquad f(u_1 + u_2) = y_1 + y_2 \]
  \item Verstärkungsprinzip erfüllt
        \[ y = f(u) \qquad f(k \cdot u) = k \cdot y \]
\end{enumerate}

\subsection{Prüfung auf Zeitvarianz}
\[ y(t) = f(u(t) \]
\[ y(t - T) = f(u(t - T)) \]

\section{Wichtige Gleichungen für die Modellierung dynamischer Systeme}

Bilanzgleichungen, Erhaltungssätze
\subsection{Elektrisches Netzwerk}
Ladungserhaltung \\
Energieerhaltung \\
$\Rightarrow$ Kirchhoffsche Regeln \\
Knotenregel $\sum I = 0$ \\
Maschenregel $\sum U = 0$ \\\\
Widerstand R
\[ \boxed{u_R(t) = R \cdot i_R(t)} \]
\[ \boxed{i_R(t) = \frac{1}{R} \cdot u_R(t)} \]
Kapazität
\[ \boxed{u_C(t) 
= \frac{1}{C} \cdot \int\limits_{0}^{t} i_C(\tau) ~ d\tau + u_C(0)} \]
\[ \boxed{\dot{u}_C(t) = \frac{1}{C} \cdot i_C(t)} \]
\[ \boxed{i_C(t) = C \cdot \frac{d u_C(t)}{d t}} \]
Induktivität
\[ \boxed{u_L(t) = L \cdot \frac{d i}{d t}} \]
\[ \boxed{i_L(t) 
= \frac{1}{L} \cdot \int\limits_{0}^{t} u_L(\tau) ~ d\tau + i_L(0)} \]

\subsection{Mechanisch (Translation)}
Newton'sche Gesetze (skalar)
\[ \boxed{\frac{d(m \cdot v)}{dt} = \sum F_i} \]
\[ \boxed{\dot{m} \cdot v + m \cdot \dot{v} = \sum F_i} \]
m = konst: 
\[ \boxed{m \cdot \dot{v} = \sum F_i} \]
\[ \boxed{x, \qquad \dot{x} = v, \qquad \ddot{x} = \dot{v} = a} \]
\[ \boxed{m \cdot \ddot{x} = \sum F_i} \]

\subsection{Mechanisch (Rotation)}
\[ \boxed{\frac{d(I \cdot \omega}{dt} = \sum M_i} \]
\[ \boxed{I = konst. } \]
\[ \boxed{I \cdot \dot{\omega} = \sum M_i} \]
\[ \boxed{\varphi, \qquad \dot{\varphi} = \omega, 
\qquad \ddot{\varphi} = \dot{\omega} = \alpha} \]

\subsection{Thermisch}
\[ \boxed{\frac{d(c \cdot M \cdot \vartheta)}{dt} = \sum Q_i} \]

\subsection{Hydraulisches System}
inkompressibel \\
Volumen / Massenbilanz
\[ \boxed{\frac{dV}{dt} = \sum q_i} \]

\subsection{pneumatisch}
\[ \boxed{} \]

\subsection{Konzentration}
\[ \boxed{} \]

\section{Linearisierung einer statischen Funktion}
Beispiel: 
\[ y = u^2 \]

\subsection{Perturbation Theory}
\[ u = u_0 + \Delta u \]
\[ y = y_0 + \Delta y \]
\[ y_0 + \Delta y = (u_0 + \Delta u)^2 \]
\[ y_0 + \Delta y = {u_0}^2 + 2 \cdot u_0 \cdot \Delta u + \Delta u ^2 \]
\[ y_0 = {u_0}^2 \]
\[ {u_0}^2 + \Delta y = {u_0}^2 + 2 \cdot u_0 \cdot \Delta u + \Delta u^2 \]
\[ \Delta y = 2 \cdot u_0 \cdot \Delta u + \underbrace{\Delta u^2}_{\approx 0} \]
\[ \underline{\underline{\Delta y = 2 \cdot u_0 \cdot \Delta u}} \]
%
Anderes Beispiel: 
\[ v = \sin(u) \]
\[ u = u_0 + \Delta u \]
\[ v = v_0 + \Delta v \]
\[ v_0 + \Delta v = \sin(u_0 + \Delta u) \]
\[ v_0 + \Delta v = \sin(u_0) \cdot \underbrace{cos(\Delta u)}_{=1} 
+ \cos(u_0) \cdot \sin(\Delta u) \]
\[ v_0 = \sin(u_0) \]
\[ \sin(u_0) + \Delta v = \sin(u_0) + \cos(u_0) \cdot \Delta u \]
\[ \Delta v = \cos(u_0) \cdot \Delta u \]
\[ \Delta v = \cos(u_0) \cdot \Delta u + v_0 \]

\subsection{Totales Differential}
\[ y = u^2 \]
\[ f(y, u) = y - u^2 = 0 \]
\[ \frac{\partial f}{\partial y} = 1 \]
\[ \frac{\partial f}{\partial u} = -2u \]
\[ f(y, u) = f(y_0, u_0) + \frac{\partial f}{\partial y}(y_0, u_0) \Delta y \]
\[ + \frac{\partial f}{\partial u} \Delta u \]
\[ = y_0 - {u_0}^2 + 1 \cdot \Delta y - 2 \cdot u_0 \cdot \Delta u = 0 \]
\[ \Delta y - 2 \cdot u_0 \cdot \Delta u = 0 \]
\[ \Delta y = 2 \cdot u_0 \cdot \Delta u \]
%
Anderes Beispiel: 
\[ f(v, u) = v - \sin(u) = 0 \]
\[ \frac{\partial f}{\partial v} = 1 \]
\[ \frac{\partial f}{\partial u} = - \cos(u) \]
eingesetzt: 
\[ f(v, u) = v_0 - \sin(u_0) + 1 \cdot \Delta v - \cos(u_0) \cdot \Delta u = 0 \]
\[ \Delta v = \cos(u_0) \cdot \Delta u \]

\subsection{Weitere Variante: }
\[ \dot{y} = u^2 - \sin(v) \]
\[ 1 \cdot \delta y = 2 \cdot u_0 \cdot \delta u - \cos(v_0) \cdot \delta v \]
\[ \delta y = \Delta y \qquad \delta u = \Delta u \]
\[ \Delta y = 2 \cdot u_0 \cdot \Delta u - \cos(v_0) \cdot \Delta v \]
Anderes Beispiel: 
\[ z = x^2 \cdot y^2 \]
\begin{itemize}
  \item Wie lautet die linearisierung der statischen, nichtlinearen Kennlinie? 
  \item Visualisieren Sie die Linearisierung in Matlab. 
\end{itemize}

\section{Ableiten mit der Überlagerungsfunktion}
\[ u_1(t) = \sigma(t) \]
\[ u_2(t) = \delta(t) \]
\[ u_3(t) = t \]
\[ u_4(t) = \sin(\omega t) \]
\[ \frac{y(s)}{u(s)} = G(s) \]
Impulsantwort: 
\[ \delta(t) \to g(t) \]
Sprungantwort: 
\[ \sigma(t) \to h(t) \]

\[ u_3(t) = t \to  \]
>>>FOSA Grafik zu Impulsantwort, Sprungantwort, ...\\
Im Laplace Bereich werden die mathematischen Operationen vereinfacht: //
Ableiten $\to$ Miltiplizieren mit $s$\\
Int egrieren $\to$ Multiplizieren mit $\frac{1}{s}$\\
>>>FOSA Grafik Blöcke in Serie\\
\[ \frac{Y(s)}{U(s)} = G_1(s) \cdot G_2(s) = G(s) \]
>>>FOSA Grafik Blöcke parallel\\
\[ \frac{Y(s)}{U(s)} = G_1(s) - G_2(s) = G(s) \]
>>>FOSA Grafik Block mit Gegenkopplung / Kreisschaltung\\
\[ E(s) = U(s) - Y(s) \]
\[ Y(s) = G_1(s) \cdot E(s) \]
\[ E(s) = \frac{Y(s)}{G_1(s)} \]
\[ \frac{Y(s)}{G_1(s)} = U(s) - Y(s) \]
\[ Y(s) = G_1(s) \cdot U(s) - G_1(s) \cdot Y(s) \]
\[ (1 + G_1(s)) \cdot Y(s) = G_1(s) \cdot U(s) \]
\[ \frac{Y(s)}{U(s)} = \frac{G_1(s)}{1 + G(s)} \]
Hilfe: \\
Zähler: Vorwärtspfad\\
Nenner: 1 $\pm$ Kreisverstärkung

\section{P-Regler}
\[ u = k_p \cdot e(t) \]
\[ e(t) = v_{soll}(t) - v(t) \]

\subsubsection{Einfluss von $k_p$ auf die Zeitkonstante}
Die Übertragungsfunktion des geschlossenen Kreises lautet
\[ G_{CL} = \frac{50 \cdot k_p}{25 \cdot s + 1 + 50 \cdot k_p} \cdot 
\frac{\frac{1}{1} + 50 \cdot k_p}{\frac{1}{1} + 50 \cdot k_p} 
= \frac{\frac{50 \cdot k_p}{1 + 50 \cdot k_p}}
{\frac{25}{1 + 50 \cdot k_p} \cdot s + 1} \]
(Führungsverhalten)

\section{I-Regler}
\[ u = k_p \cdot e(t) + k_i \cdot \int\limits_0^t (e(t)) ~ dt \]
\[ e(t) = v_{soll}(t) - v(t) \]
\[ U(s) = k_p \cdot E(s) + k_i \cdot \frac{1}{s} \cdot E(s) \]
\[ U(s) = \left( k_p + \frac{k_i}{s} \right) \cdot \left( V_{soll}(s) - V(s) \right) \]

\subsection{Bestimmung der Reglerkoeffizienten durch Polynomvergleich}
\[ 2 D \omega_0 = 0.04 + 2 k_p \]
\[ {\omega_0}^2 = 2 k_i \]
Vorgabe von $\omega_0$ und $D$
\[ \omega_0 = 0.1 \qquad D = 1 \]
\[ k_i = \frac{{\omega_0}^2}{2} = 0.005 \]
\[ k_p = \frac{2 D \omega_0 - 0.04}{2} = 0.08 \]

\section{Nullstellen}
\[ 0.16 \cdot s + 0.01 \stackrel{!}{=} 0 \]
\[ 0.16 \cdot s = -0.01 \]
\[ n_1 = s = -\frac{0.01}{0.16} = 0.0625 \]
>>>FOSA Grafik Pol/Nullstellenplan

\section{Pole}
bestimmen BIBO-Stabilität
\[ s^2 + 0.2 s + 0.01 = 0 \]
\[ s_{1,2} = \frac{-0.2 \pm \sqrt{0.2^2 - 4 \cdot 0.01}}{2} \]

\section{Pol / Nullstellenplan}
\[ G(s) = \frac{Z(s)}{N(s)} \]
Pole: 
\[ N(s) = 0 \qquad s_{N_1}, s_{n_2}, \ldots \]
Nullstellen: 
\[ Z(s) = 0 \qquad s_{Z_1}, s_{Z_2}, \ldots \]
Eine Übertragungsfunktion n-ter Ordnung besitzt n Pole. Diese können reell, 
konjugiert-komplex, einfach ider mehrfach sein. \\
Bsp. 
\[ G(s) = \frac{b_0}{s^2 + a_1 s + a_0} \]
keine Nullstellen (kein s im Zähler)\\
\[ s^2 + a_1 s + a_0 = 0 \]
\[ s_{1, 2} = -\frac{a_1}{2} \pm \sqrt{\frac{{a_1}^2}{4} - a_0} \]
Annahme: 
\[ a_1 = 4 \qquad s_{1, 2} = -2 \pm \sqrt{4 - a_0} \]
\[ a_0 = 3 \qquad s_1 = - 1 \qquad s_2 = -3 \]
>>>FOSA Grafik Pole Annahme 1\\
Annahme: 
\[ a_0 = 8 \qquad s_{1, 2} = -2 \pm 2 j \]
>>>FOSA Grafik Pole Annahme 2\\
\subsection{P/N - Darstellung}
Bsp. 
\[ G(s) = \frac{4 s^2 + 20s + 16}{2 s^3 + 16 s^2 + 50 s + 52} 
= 2 \cdot \frac{(s+4)(s+1)}{(s+2)(s+3-2j)(s+3+2j)} \]
\[ s_{Z_1} = -1 \qquad s_{Z_2} = -4 \]
\[ s_{N_1} = -2 \qquad s_{N_2} = -3 + j 2 \qquad s_{N_3} = -3 - j 2 \]

\section{Stabilität}
>>>FOSA Grafik Stabilität
\[ a_n y^{(n)} + a_{n-1} y^(n-1) + \ldots + a_1 \dot{y} + a_0 y = 0 \]
\[ y = c_1 e^{s_1 t} + c_2 e^{s_2 t} + \ldots \]
\[ s_{1, 2} = \sigma \pm j \omega \]
\[ y = c_1 e^{(\sigma + j \omega)t} + {c_1}^* e^{(\sigma - j \omega)t} + \ldots \]
\[ e^{\pm j \omega t} = \omega s \omega t \pm j sin(\omega t) \]
\[ y = e^{\sigma t}(c_1 e^{j \omega t} + {c_1}^* e^{-j \omega t}) 
= e^{\sigma t}(c_2 \cos(\omega t + \varphi))\ldots \]

\subsection{Hurwitz-Kriterium}
\[ a_n s^n + a_{n-1} s^{n-1} + \ldots + a_1 s + a_0 = 0 \]
\[ \begin{array}{cccc}
a_1 & a_3 & a_5 & a_7 \\
a_0 & a_2 & a_4 & a_6 \\
0   & a_1 & a_3 & a_5 \\
0   & a_2 & a_4 & a_6 \\
\end{array} \]
Alle Nullstellen von (*) haben einen negativen Realteil, wenn 
\begin{enumerate} 
  \item alle Koeffizienten $a_1, a_1, \ldots, a_n$ ungleich null sind und ein 
        positives Vorzeichen haben und 
  \item die Hurwitz-Determinante sowie die 
  \item Unterdeterminante grösser sind. 
\end{enumerate}
Weiteres Verfahren: Routh-Schema

\section{Frequenzgang}
\subsubsection{Definition}
Wir betrachten ein lineares zeitinvariantes System, das in Ruhe ist. 
Dann gibt man eine harmonische Schwingung auf den Eingang und beobachtet die 
Ausgangsschwingung nach unendlich langer Zeit. Es interessiert uns das 
Verhältnis zwischen Ausgangsschwingung und Eingangsschwingung im 
eingeschwungenen Zustand. Einschwingvorgänge werden nicht berücksichtigt im 
Gegensatz zur Laplacetransformation. \\
>>>FOSA Grafik zu Sinussignalen am Linearen System
\[ u(t) = \hat{u} \cos(\omega t + \vartheta) \]
\[ y(t) = \hat{y} \cos(\omega t + \varphi) \]
\begin{tabular}{ll}
$\hat{u}$, $\hat{y}$ & Amplitude \\
$\omega$          & Kreisfrequenz \\
\end{tabular}
\[ \omega = \frac{2 \pi}{T} = 2 \pi f \]
>>>FOSA Grafik zu Phasenvershiebung\\
Phasenverschiebung in Zeit oder in rad, nach rechts ist Phase negativ, da 
verzögert. 
\subsubsection{Darstellung}
Tabelle: \\
\begin{tabular}{lcccc}
Frequenz   & Amplitude Eingang & Phase Eingang & Amplitude Ausgang & Phase Ausgang \\
$\omega_1$ &
  $\hat{u}(\omega_1)$ &
  $0$ &
  $\hat{y}(\omega_1)$ &
  $\varphi(\omega_1)$ \\
$\omega_2$ &
  $\hat{u}(\omega_2)$ & 
  $0$ & 
  $\hat{y}(\omega_2)$ & 
  $\varphi(\omega_2)$ \\

\end{tabular}

\subsection{Bodediagramm}
Man trägt das Amplitudenverhältnis und den Phasengang $\varphi(\omega) - 0$ 
in zwei verschiedene Diagramme ein. 

\subsubsection{Amplitudengang}
doppelt logarithmisch\\
x-Achse: $\log \omega$ \\
y-Achse: $\frac{\hat{y}}{\hat{u}}$ in $dB$\\
\[ dB = 20 \cdot \log\left( \frac{\hat{y}(\omega)}{\hat{u}(\omega)} \right) \]

\subsubsection{Phasengang}
Einfach logarithmisch\\
x-Achse: $\log(\omega)$ \\
y-Achse: $\varphi(\omega)$ \\

\subsection{Ortskurve, Nyguistdiagramm}
Man Zeichnet die beiden Grössen Amplitudenverhältnis $|G(j \omega)|$ und 
Phase $\varphi(\omega)$ als Zeiger in die komplexe G-Ebene ein. 
\[ Q(j \omega) = |G(j \omega)| \cdot e^{j \varphi(\omega)} \]
\[ Re =  |G(j \omega)| \cdot \cos(\varphi(\omega)) \]
\[ Im =  |G(j \omega)| \cdot \sin(\varphi(\omega)) \]
\[ |G(j \omega)| = \sqrt{Re^2 + Im^2} \]
\[ \varphi(\omega) = \arctan(\frac{Im}{Re}) \]
>>>FOSA Grafik Ortskurve \\

\section{LZI-Glieder}

\subsection{Verstärker}
\[ G(s) = K \]

\subsection{Verzögerungselement 1. Ordnung (PT$_1$)}
\[ G(s) \frac{K}{T_1 s + 1} \]
>>>FOSA Grafik PT1

\subsection{Verzögerungselement 2. Ordnung (PT$_2$)}
\[ G(s) = \frac{K \cdot {\omega_0}^2}{s^2 + 2 d \omega_0 s + {\omega_0}^2} \]
\begin{tabular}{ll@{$ ~ \rightarrow ~ $}l}
$K$ & Verstärkungsfaktor & Endwert \\
$d$ & Dämpfung & Überschwingen \\
$\omega_0$ & Eigenkreisfrequenz & Schwingfrequenz \\
\end{tabular}
\[ \frac{Y(s)}{U(s)} = \frac{K \cdot {\omega_0}^2}{s^2 + 2 d \omega_0 s + {\omega_0}^2} \]
\[ Y(s) (s^2 + 2 d \omega_0 s + {\omega_0}^2) = K \cdot {\omega_0}^2 \cdot U(s) \]
\[ \ddot{y}(t) + 2 d \omega_0 \dot{y}(t) + {\omega_0}^2 y(t) = K \cdot {\omega_0}^2 \cdot u(t) \]
\[ \ddot{y}(t) = K \cdot {\omega_0}^2 \cdot u(t) - 2 d \omega_0 \dot{y}(t) - {\omega_0}^2 \cdot y(t) \]
Pole des PT$_2$ Elementes
\[ s^2 + 2 d \omega_0 s + {\omega_0}^2 \]
\[ s_{1/2} = \frac{-2 d \omega_0 \pm \sqrt{4 d^2 {\omega_0}^2 - 4 {\omega_0}^2}}{2} \]
\[ s_{1/2} = -d \omega_0 \pm \omega_0 \cdot \sqrt{d^2 - 1} \]
Fallunterscheidung: 
\[ d > 1: \]
\[ s_1 = -d \omega_0 + \omega_0 \sqrt{d^2 - 1} \]
\[ s_1 = -d \omega_0 - \omega_0 \sqrt{d^2 - 1} \]
\[ s^2 + 2 d \omega_0 s + {\omega_0}^2 = (s - s_1) (s - s_2) \]

\[ d = 1: \]
\[ s_{1/2} = -d\omega_0 \]

\[ d < 1: \]
\[ s_1 = -d\omega_0 + j \omega_0 \sqrt{1 - d^2} \]
\[ s_1 = -d\omega_0 - j \omega_0 \sqrt{1 - d^2} \]

Das PT$_2$-Element mit Dämpfung $d = \frac{\sqrt{2}}{2}$ entspricht einer 
"'perfekten"' Antwort für einen geschlossenen Regelkreis. 


